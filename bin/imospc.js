(function(v,$){function La(a){function b(){throw new TypeError("Illegal constructor");}a&&z(b,"prototype",a);return b}function Ma(){for(var a=-1,b=arguments.length;++a<b;){var c=arguments[a].prototype;z(c,"constructor",mb);z(arguments[a],"prototype",c)}}function oa(a){var b;b=h["on"+a];if(b!==I[a]&&k(b))b=1;else{b=w[a];var c=b.length,d=0;if(Array.isArray(b)&&c){for(var e=-1,f=b.length;++e<f;){var g=b[e];!k(g)&&(!A(g)||!k(g.handleEvent))&&d++}b=d<c}else b=void 0}if(!b)throw new TypeError(a+" event must be handled.");
}function Na(a,b,c){a=w[a];if(Array.isArray(a))for(var d=-1,e=a.length;++d<e;){var f=a[d];k(f)?f.call(b,c):A(f)&&k(f.handleEvent)&&f.handleEvent(c)}}function aa(a,b,c){var d=h["on"+a],b=b||h;if(d!==I[a]&&k(d))try{d.call(b,c)}catch(e){}else Na(a,b,c)}function Ca(a){aa("initerror",0,a)}function ga(a){aa("loaderror",0,a)}function O(a){aa("playstatechange",0,a)}function pa(a,b,c){a.prototype[b]||(a.prototype[b]=c)}function A(a){return a!==f&&a!==E}function k(a){return"function"===typeof a}function Da(){}
function Oa(a){if(!isNaN(a))return a;for(var a=String(a),b=0,c=-1,d=a.length;++c<d;)b=31*b+a.charCodeAt(c);return b}function qa(a){a.length=0}function F(a,b){return(a||"").localeCompare(b||"")}function Pa(a,b){return F(a.url,b.url)||F(a.title,b.title)}function Ea(a,b){return F(a.title,b.title)||F(a.url,b.url)}function Fa(a,b){return F(a.osttitle,b.osttitle)||(a.ostdisc|0)-(b.ostdisc|0)||(a.osttracknum|0)-(b.osttracknum|0)||F(a.osttrackchar,b.osttrackchar)||Ea(a,b)}function T(a){var b="[ImoSPC v1.9.1, "+
("html5"===a?"HTML5]":"unitialized]");x(this,{runtime:a,major:1,minor:9,build:1,toString:function(){return b}})}function ba(a,b){x(this,{version:a||ra,error:b||sa})}function K(a,b,c,d,e,g,h){x(this,{url:a,userdata:b,track:c,playlist:g?E:d,corruptFiles:e,error:g,httpStatus:"download error"===g?h:f})}function J(a,b,c,d,e,f){x(this,{state:a,track:b,playlist:c,index:d,previousTrack:e,previousIndex:f})}function Qa(a){if(U!==f)a(U);else{var b=v.webkitURL||v.URL;if(!Ra||!ta||!ha||!nb||!v.Blob||!k(b.createObjectURL))C=
u(ka?["flash"]:[]),a(U=!1);else try{var c=new Blob(['postMessage(self.FileReaderSync?"a":"")'],{type:"text/javascript"}),d=b.createObjectURL(c),e=new ta(d);e.onmessage=function(c){b.revokeObjectURL(d);e.terminate();C=c?["html5"]:[];ka&&C.unshift("flash");u(C);a(U=!!c)}}catch(g){C=u(ka?["flash"]:[]),a(U=!1)}}}function ob(a){for(var b="",a=a.split("%"),c=1,d=a.length;c<d;){var e=parseInt(a[c++],16);if(127<e){var f,g;if(192===(e&224))f=1,e&=31,g=128;else if(224===(e&240))f=2,e&=15,g=2048;else if(240===
(e&248))f=3,e&=7,g=65536;else{for(f=248===(e&252)?4:252===(e&254)?5:0;0<=--f;){var h=parseInt(a[c],16);if(128!==(h&192))break;c++}e=65533}for(;0<=--f;){h=parseInt(a[c],16);if(128!==(h&192)){e=65533;break}c++;e=e<<6|h&63}if(e<g||1114111<e||65534===e||65535===e)e=65533}65535<e?(e-=65536,b+=String.fromCharCode(55296+(e>>10),56320+(e&1023))):b+=String.fromCharCode(e)}return b}function Sa(){var a=[],b=[],c=[];this.remove=function(d){for(var e=Oa(d),f=-1,g=a.length;++f<g;)if(a[f]===e&&b[f]===d)return d=
c[f],a.splice(f,1),b.splice(f,1),c.splice(f,1),d};this.add=function(f,e){a.push(Oa(f));b.push(f);c.push(e)}}function P(a){var b=this;pb.forEach(function(c,f){z(b,c,a[f])});var c=a[0];if(c){var f,c=String(c),e=c.indexOf("#");0<=e?(f=c.substring(0,e),c=c.substring(e+1),c=String(c).replace(/((?:%[a-f\d]{2})+)/ig,ob),x(this,{archive:f,path:c}),f=c.substring(c.lastIndexOf("/")+1)):f=c.lastIndexOf("data:",0)?c.lastIndexOf("blob:",0)?c.substring(c.search(/[^\/\\]*$/)):"[blob]":"[data]";z(b,"filename",f)}z(b,
"length",+a[12]+ +a[13])}function V(a){if(!(a instanceof P))throw new TypeError("Track functions can only be called on Track objects.");}function Q(a,b){return!a||!b?a===b:a.url===b.url}function R(a){z(this,"tracks",u(a));x(this,{tracks:u(a),length:a.length})}function Ga(a){if(!Array.isArray(a))throw new TypeError("tracks is not an array.");if(!a.length)throw new TypeError("tracks is empty.");a.forEach(function(a){if(!(a instanceof P))throw new TypeError("tracks contains an invalid track.");});R.call(this,
a.slice())}function m(a){if(!(a instanceof R))throw new TypeError("Playlist functions can only be called on Playlist objects.");}function y(a){return(s||p)===a}function Ta(a){function b(){if(B=$.body||$.getElementsByTagName("body")[0])if(B.appendChild(l),t&&(l=v._ImoSwf),Ha(function(){if(d){clearTimeout(d);d=null;ua=!1;va=function(a,b){if(!a)throw new TypeError("url is not specified.");var a=X(location.href,a),e,d;b&&(e=b.autostart,d=b.userdata);(e=!!(e!==f?e:h.autostart))||oa("load");d!==f&&u.add(a,
d);e&&(G(),j=a,s=i=la=n=r=f);l._getinfo(a.replace(/[&\\"'\r\n]/g,c))};M=function(a,b,e){ca();n=!1;var d=e?b:f;e&&(b=e.tracks[d]);var h=b.length;if(0>a)a+=h,0>a&&(a=0);else if(a>=h)if(e&&++d<e.tracks.length)a=0,b=e.tracks[d];else return G(),f;if(b!==g){if(!e||e!==p)G();else{l._stop(!1);var L=g,k=q;g=q=f}j=X(location.href,b.url);i=b;s=e;r=d;la=a;O(new J("loading",i,s,r,L,k));l._load(j.replace(/[&\\"'\r\n]/g,c),+b._fSt,+b._fLn)}else r=s=j=i=f,p=e,q=d,l._seek(a),l._resume()};Z=function(){return j?n=!0:
l._pause()};da=function(){ca();return j?(n=!1,!0):l._resume()};G=function(){return j?(j=i=s=r=la=f,!0):l._stop(!0)};ea=function(){return l._tell()||-1};ma=function(a){l._setVol(a)};var a={badspc:"invalid spc",badzip:"invalid zip",empty:"empty archive",unkty:"unknown file type",badurl:"invalid url",dlerr:"download error",http:"download error",security:"download error",dlabt:"download aborted",nofile:"path not found in archive",io:"io error"};Ia(function(a,b,c){a=e(a);if(b)for(var d=-1,g=b.length;++d<
g;){var h=b[d];Array.isArray(h)&&k(h)}k(c);d=u.remove(a);if(b.length){g=-1;for(h=b.length;++g<h;){var l=b[g]=new P(b[g]);d!==f&&z(l,"userdata",d)}g=new R(b);d!==f&&z(g,"userdata",d);b=new K(a,d,1===b.length?b[0]:f,g,c||[],sa);aa("load",0,b);a===j&&!i&&(j=f,a=n,M(0,0,g),n=a)}else ga(new K(a,d,f,f,c,"empty archive"))},function(a){a=e(a);a===j&&(a=la,g=i,p=s,q=r,j=i=s=la=r=f,l._start(n),0<a&&l._seek(a),n&&O(new J("paused",g,p,q)))},function(b,c,d){b=e(b);"string"===typeof d&&(d=e(d));var c=a[c],g,h,
l;i?(g=i.userdata,r=s=j=i=f):(g=u.remove(b),b===j&&(r=s=j=i=f));switch(c){case "download error":h=+d||f;break;case "invalid spc":case "empty archive":case "path not found in archive":l=Array.isArray(d)?d:[]}ga(new K(b,g,i,s,l,c,h))},function(a){var b,c=g,d=p,e=q;switch(a){case "buffering":b="buffering";break;case "playing":b="playing";break;case "paused":b="paused";break;case "end":if(p&&h.autoplay&&++q<p.tracks.length){M(0,q,p);return}case "stopped":b="stopped",g=p=q=f}O(new J(b,c,d,e))});wa(!0);
xa(Ua);var b=new ba(Ua);aa("init",0,b)}}),"none"===l.style.display||l.bgInactive)Ca(new ba(E,"swf blocked"));else var d=setTimeout(function(){ua=!1;B.removeChild(l);d=l=null;Ca(new ba(E,"swf load timeout"))},a&&+a.timeout||5E3);else setTimeout(b,100)}function c(a){return A[a]||a}function d(a){return x[a.toLowerCase()]||a}function e(a){return a.replace(/&(?:amp|quot|#x(?:5C|27|0D|0A));/gi,d)}function k(a){if(a)for(var b=-1,c=a.length;++b<c;){var d=a[b];"string"===typeof d&&(a[b]=e(d))}return a}var m=
X(ya,"imo-fl.swf"),l=$.createElement("div");l.innerHTML='<object id="_ImoSwf" type="application/x-shockwave-flash" data="'+m+'" style="width:1px;height:1px;position:absolute;top:0;'+(t?'left:-1px" classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000':"left:0;visibility:hidden")+'"><param name="movie" value="'+m+'"/><param name="allowScriptAccess" value="always"/></object>';l=l.firstChild;ua=!0;var B,A={"&":"&amp;","\\":"&#x5C;",'"':"&quot;","'":"&#x27;","\r":"&#x0D;","\n":"&#x0A;"},x={"&amp;":"&",
"&#x5c;":"\\","&quot;":'"',"&#x27;":"'","&#x0d;":"\r","&#x0a;":"\n"},u=new Sa,n,la;b()}var f,E=null,mb=La(),w={init:[],initerror:[],load:[],loaderror:[],playstatechange:[]},I={},qb=function(a){return function(b){Na(a,this,b)}},za;for(za in w)w.hasOwnProperty(za)&&(I[za]=qb(za));var t;var Ja=window.navigator.userAgent,Ka=Ja.indexOf("MSIE ");t=0<Ka?parseInt(Ja.substring(Ka+5,Ja.indexOf(".",Ka)),10):void 0;if(!Array.isArray||t&&9>t)Array.isArray=function(a){return"[object Array]"===Object.prototype.toString.call(a)};
var Ra=v.ArrayBuffer,ha=v.AudioContext||v.webkitAudioContext,ta=v.Worker,nb=v.XMLHttpRequest,u=Object.freeze||function(a){return a};pa(Array,"forEach",function(a,b){b||(b=null);for(var c=this.length>>>0,d=-1;++d<c;)d in this&&a.call(b,this[d],d,this)});pa(Array,"indexOf",function(a,b){var c=this.length>>>0,b=b|0;0>b&&(b+=c,0>b&&(b=0));for(;b<c;b++)if(this[b]===a)return b;return-1});var z,x;Object.defineProperty&&(!t||8<t)?(z=function(a,b,c,d){Object.defineProperty(a,b,{configurable:!1,writable:!1,
enumerable:!d&&"prototype"!==b,value:c})},x=function(a,b,c){for(var d in b)b[d]={configurable:!1,writable:!1,enumerable:!c,value:b[d]};Object.defineProperties(a,b)}):(z=function(a,b,c){a[b]=c},x=function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])});var X,Va=function(a){return(a=String(a).replace(/^\s+|\s+$/g,"").match(/^([^:\/?#]+:)?(\/\/(?:[^:@]*(?::[^:@]*)?@)?(([^:\/?#]*)(?::(\d*))?))?([^?#]*)(\?[^#]*)?(#[\s\S]*)?/))?{href:a[0]||"",protocol:a[1]||"",authority:a[2]||"",host:a[3]||"",hostname:a[4]||
"",port:a[5]||"",pathname:a[6]||"",search:a[7]||"",hash:a[8]||""}:null};X=function(a,b){var b=Va(b||""),a=Va(a||""),c;if(!b||!a)c=null;else{c=(b.protocol||a.protocol)+(b.protocol||b.authority?b.authority:a.authority);var d;d=b.protocol||b.authority||"/"===b.pathname.charAt(0)?b.pathname:b.pathname?(a.authority&&!a.pathname?"/":"")+a.pathname.slice(0,a.pathname.lastIndexOf("/")+1)+b.pathname:a.pathname;var e=[];d.replace(/^(\.\.?(\/|$))+/,"").replace(/\/(\.(\/|$))+/g,"/").replace(/\/\.\.$/,"/../").replace(/\/?[^\/]*/g,
function(a){"/.."===a?e.pop():e.push(a)});d=e.join("").replace(/^\//,"/"===d.charAt(0)?"/":"");c=c+d+(b.protocol||b.authority||b.pathname?b.search:b.search||a.search)+b.hash}return c};var ya,Wa=$.getElementsByTagName("script");ya=X(location.href,Wa[Wa.length-1].src);var sa=f,rb=u({SUCCESS:sa,UNKNOWN:"unknown error",INVALID_SPC:"invalid spc",INVALID_ZIP:"invalid zip",EMPTY_ARCHIVE:"empty archive",UNKNOWN_FILE_TYPE:"unknown file type",BAD_URL:"invalid url",DOWNLOAD_ERROR:"download error",DOWNLOAD_ABORTED:"download aborted",
IO_ERROR:"io error",PATH_NOT_FOUND:"path not found in archive",BROWSER_NOT_SUPPORTED:"browser not supported",TIMEOUT:"swf load timeout",FLASHBLOCK:"swf blocked"}),Xa=E,sb=u({NONE:Xa,HTML5:"html5",FLASH:"flash"}),tb=u({STOPPED:"stopped",PLAYING:"playing",PAUSED:"paused",BUFFERING:"buffering",LOADING:"loading"}),ub=u({Title:Ea,Game:function(a,b){return F(a.game,b.game)||Ea(a,b)},URL:Pa,Filename:function(a,b){return F(a.filename,b.filename)||Pa(a,b)},Chronological:Fa});Ma(T);var ra=new T(Xa),Ya=new T("html5"),
Ua=new T("flash");Ma(ba,K,J);var U,C,ka=function(){var a,b,c=navigator.plugins,d=navigator.mimeTypes;if(!t&&c)if(c["Shockwave Flash"])if((a=c["Shockwave Flash"].description)&&(!d||!d["application/x-shockwave-flash"]||d["application/x-shockwave-flash"].enabledPlugin)){var e=a.match(/(\d+)/g);a=e[0];b=e[1]}else return;else return;else if("function"===typeof ActiveXObject)try{e=(new ActiveXObject("ShockwaveFlash.ShockwaveFlash")).GetVariable("$version"),e=e.split(" ")[1].split(","),a=e[0],b=e[1]}catch(f){return}else return;
a=parseInt(a,10);b=parseInt(b,10);return 11<a||11===a&&5<=b}(),ca;if("undefined"!==v.Storage){ca=function(){try{h.allowMultipleInstances||localStorage.setItem("_ImoCurrentInstanceController",localStorage.getItem("_ImoCurrentInstanceController")^1)}catch(a){}};var Za=function(a){Z&&"_ImoCurrentInstanceController"===(a||v.event).key&&Z()};k(v.addEventListener)?v.addEventListener("storage",Za,!1):k(v.attatchEvent)?v.attatchEvent("onstorage",Za):ca=Da}else ca=Da;var Aa=1,va,M,Z,da,G,ea,ma,p,g,q,j,i,s,
r,B,wa,xa,$a,pb="url _ofs title game artist publisher copyright osttitle ostdisc osttrack osttracknum osttrackchar _fSt _fLn".split(" ");x(P.prototype,{play:$a=function(a){V(this);M(+a||0,this)},pause:function(){V(this);return Q(i||g,this)?Z():!1},unpause:function(){V(this);return Q(i||g,this)?da():!1},stop:function(){V(this);return Q(i||g,this)?G():!1},time:function(){V(this);return Q(g,this)?ea():-1},seek:function(a,b){V(this);if(isNaN(a))throw new TypeError("to must be a number.");if(Q(g,this)&&
(a||!b)){var c=ea();if(0<=c)return b&&(a+=c),M(a,p?q:g,p),!0}return!1},toString:function(a){a=this;return"[ImoSPC.Track, "+(a.title||a.filename||a.url)+"]"}});var ab;x(R.prototype,{constructor:Ga,play:ab=function(a,b){m(this);var c=this.tracks;if(A(a)&&isNaN(a))if(a instanceof P)a=c.indexOf(a);else throw new TypeError("track must be a Track object or the index of a track.");else a=+a;if(A(b)&&isNaN(b))throw new TypeError("startAt must be a number.");if(0>a||a>c.length||!(c[a>>>=0]instanceof P))throw new RangeError("track is not in the playlist.");
M(+b||0,a,this)},pause:function(){m(this);return y(this)?Z():!1},unpause:function(){m(this);return y(this)?da():!1},stop:function(){m(this);return y(this)?G():!1},first:function(){m(this);return this.tracks[0]},previous:function(){m(this);return y(this)?this.tracks[(A(r)?r:q)-1]:f},current:function(){m(this);return y(this)?i||g:f},next:function(){m(this);return y(this)?this.tracks[(A(r)?r:q)+1]:f},last:function(){m(this);var a=this.tracks;return a[a.length-1]},indexOfFirst:function(){m(this);return 0},
indexOfPrevious:function(){m(this);return y(this)?q-1:-1},indexOfCurrent:function(){m(this);return y(this)?g:-1},indexOfNext:function(){m(this);var a=this.tracks.length,b=(A(r)?r:q)+1;return y(this)&&b<a?b:-1},indexOfLast:function(){m(this);return this.tracks.length-1},sort:function(a){m(this);if(A(a)){if(!k(a))throw new TypeError("compareFunction is not a function.");}else a=Fa;return new R(this.tracks.slice().sort(a))},sortReverse:function(a){m(this);if(A(a)){if(!k(a))throw new TypeError("compareFunction is not a function.");
}else a=Fa;return new R(this.tracks.slice().sort(a).reverse())},toString:function(){return"[ImoSPC.Playlist, "+this.length+" track(s)]"}});z(Ga,"prototype",R.prototype);var ua,h={};x(h,{Error:rb,Runtime:sb,PlaybackState:tb,TrackSort:ub,Playlist:Ga,Track:La(P.prototype),InitEvent:ba,LoadEvent:K,PlayStateEvent:J,currentTrack:function(){return i||g},currentPlaylist:function(){return s||p},querySupportedRuntimes:function(a){U!==f?a(C):Qa(function(){a(C)})},open:function(a,b){va(a,b)},play:function(a,
b,c){if(!arguments.length)throw new TypeError("ImoSPC.play() cannot be called without arguments.");if(a instanceof R)ab.call(a,b,c);else if(a instanceof P)$a.call(a,b);else throw new TypeError("The first argument of ImoSPC.play() must be a track or playlist.");},pause:function(){return Z()},unpause:function(){return da()},stop:function(){return G()},time:function(){return ea?ea():-1},getVolume:function(){return Aa},setVolume:function(a){if(isNaN(a=+a))throw new TypeError("volume must be a number.");
if(0>a||1<a)throw new RangeError("volume must be between 0 and 1.");Aa=a;ma&&ma(a);return Aa},canSeek:!0,canSetVolume:!0,addEventListener:function(a,b){if(!k(b)&&(!A(b)||!k(b.handleEvent)))throw new TypeError("callback must be a function or event handler.");var c=w[a];Array.isArray(c)&&c.push(b)},removeEventListener:function(a,b){if(!k(b)&&(!A(b)||!k(b.handleEvent)))throw new TypeError("callback must be a function or event handler.");var c=w[a];if(Array.isArray(c)){var d=c.lastIndexOf(b);0<=d&&c.splice(d,
1)}},toString:function(){return String(this.version)}});if(Object.defineProperties&&(!t||8<t)){var bb=ra,cb=!1,db=!0,eb=!1;Object.defineProperties(h,{isFunctional:{enumerable:!0,configurable:!1,get:function(){return!(!va||!M||!Z||!da||!G||!ea||!ma)}},version:{enumerable:!0,configurable:!1,get:function(){return bb}},autostart:{enumerable:!0,configurable:!1,get:function(){return cb},set:function(a){cb=!!a}},autoplay:{enumerable:!0,configurable:!1,get:function(){return db},set:function(a){db=!!a}},allowMultipleInstances:{enumerable:!0,
configurable:!1,get:function(){return eb},set:function(a){eb=!!a}}});wa=function(){};xa=function(a){bb=a}}else(wa=function(a){h.isFunctional=!!a})(!1),(xa=function(a){h.version=a})(ra),h.autostart=!1,h.autoplay=!0,h.allowMultipleInstances=!1;for(var Ba in w)if(w.hasOwnProperty(Ba)){var fb="on"+Ba,gb=I[Ba];Object.defineProperty&&(!t||8<t)?function(a,b,c){Object.defineProperty(h,b,{enumerable:!0,configurable:!1,get:function(){return c},set:function(d){if(d)if(k(d))c=d;else throw new TypeError(b+" must be a function.");
else c=I[a]}})}(Ba,fb,gb):h[fb]=gb}z(v,"ImoSPC",h);var Ha,Ia;if(Object.defineProperties&&(!t||8<t)){var hb,ib,jb,kb,lb;Object.defineProperties(h,{_ready:{enumerable:!1,configurable:!1,get:function(){return hb}},_ongetinfo:{enumerable:!1,configurable:!1,get:function(){return ib}},_loaded:{enumerable:!1,configurable:!1,get:function(){return jb}},_onloaderror:{enumerable:!1,configurable:!1,get:function(){return kb}},_setstate:{enumerable:!1,configurable:!1,get:function(){return lb}}});Ha=function(a){hb=
a};Ia=function(a,b,c,d){ib=a;jb=b;kb=c;lb=d}}else Ha=function(a){h._ready=a},Ia=function(a,b,c,d){h._ongetinfo=a;h._loaded=b;h._onloaderror=c;h._setstate=d};z(h,"init",function(a){oa("init");oa("initerror");if(h.isFunctional||ua)throw Error("ImoSPC is already initialized");a&&("autoplay"in a&&(h.autoplay=!!a.autoplay),"autostart"in a&&(h.autostart=!!a.autostart),"allowMultipleInstances"in a&&(h.allowMultipleInstances=!!a.allowMultipleInstances));ka&&(!a||!("preferredRuntime"in a&&"html5"===a.preferredRuntime))?
Ta(a):Qa(function(b){if(b){var c=function(){n=new ha;u=n.createGain();u.gain.value=Aa;u.connect(n.destination);L=n.createGain();L.connect(u);F=new ta(X(ya,"imo-w-unzip.js"));W=new ta(X(ya,"imo-w-spc.js"));F.onmessage=d;W.onmessage=e;W.postMessage({msg:"setr",rate:w=n.sampleRate});var a=new Ra(1);W.postMessage({msg:"test",x:a},[a]);x=!a.length;c=Da},d=function(a){var a=a.data,b="ok"===a.msg,c=a.url;switch(a.from){case "info":var d=a.bad||[],e=a.ls,g;a.u&&(g=$.remove(c));if(b){e=a.ls;if(!e.length){ga(new K(c,
g,f,f,d,"empty archive"));break}var h=[];e.forEach(function(a){a=new P(a);g!==f&&z(a,"userdata",g);h.push(a)});b=new R(h);g!==f&&z(b,"userdata",g);d=new K(c,g,1===b.length?h[0]:f,b,d,sa);aa("load",0,d);a.ap&&j===c&&(c=B,M(0,0,b),B=c)}else e=T[a.e]||"unknown error",a="download error"===e?a.code:f,ga(new K(c,g,f,f,d,e,a||f)),c===j&&(j=i=s=r=E);break;case "load":if(c!==j)break;b?(c=a.url,b=a.fi,a=a.at,W.postMessage({msg:"load",url:c,fi:b},x?[b]:f),a&&W.postMessage({msg:"seek",url:c,to:a*w})):(e=T[a.e]||
"unknown error",a="download error"===e?a.code:f,d=i,b=s,j=i=s=r=E,ga(new K(c,d.userdata,d,b,[],e,a)))}},e=function(a){var a=a.data,b="ok"===a.msg,c=a.url;switch(a.from){case "load":if(c!==j)break;b?(g=i,p=s,q=r,D=ia=C=0,I=+g._fSt,ja=+g.length,B?O(new J("paused",g,p,q)):k(),l()):"wrong url"!==a.e&&ga(new K(c,i.userdata,i,s,[],T[a.e]));j=i=s=r=E;break;case "samp":if(!g||c!==g.url)break;b&&(fa--,N.push(a.dat),l());break;case "seek":if(!g||c!==g.url)break;b&&(D=+a.at,0)}},k=function(){m();H=-1/0;B=0;
L.gain.value=1;y=n.createScriptProcessor(Y,0,2);y.onaudioprocess=v;y.connect(L)},m=function(){t();L.gain.value=0;y&&(y.disconnect(),y=y.onaudioprocess=E)},l=function(){if(g)for(var a=ja*w,b=D+(N.length+fa)*Y,c=U-(N.length+fa),d;0<c--&&b<a;)S.length>V?(d=S.shift(),x||(d=f)):d=f,W.postMessage({msg:"samp",url:g.url,rcl:d},d&&[d]),b+=Y,fa++},v=function(a){if(!g)throw Error("No track is loaded.");if(n.currentTime+H>=ja)return h.autoplay&&p&&++q<p.tracks.length?(m(),M(0,q,p)||(g=f)):G(),f;var b=a.playbackTime;
isNaN(b)&&(b=n.currentTime+Y/w);var c=a.outputBuffer,a=c.getChannelData(0),d=c.getChannelData(1),e=N.shift();if(e){S.push(e);var i=D/w;if(C||!ia)C=0,H=-1/0,ia=1,t(),O(new J("playing",g,p,q));if(b+H<i||na)if(na=0,H=i-b,!Q&&isFinite(H)){var j=n.currentTime,i=j+H,b=ja-H;i<I?(i=1,j=I-H):i=-((i-I)/(ja-I))+1;var k=L.gain;k.value=i;k.setValueAtTime(i,j);k.linearRampToValueAtTime(0,b);Q=1}b=new Int16Array(e);i=e=-1;for(c=c.length;++e<c;)a[e]=b[++i]/32768,d[e]=b[++i]/32768;D+=c}else{e=-1;for(c=c.length;++e<
c;)a[e]=d[e]=0;if(b+H<ja&&(!C||!ia))ia=C=1,t(),O(new J("buffering",g,p,q))}l()},t=function(){L.gain.cancelScheduledValues(Q=0);L.gain.value=1},A=function(){m();qa(N);qa(S);B=fa=0;g=E};pa(ha,"createGain",ha.prototype.createGainNode);pa(ha,"createScriptProcessor",ha.prototype.createJavaScriptNode);var x,n,u,L,y,w,F,W,C,Y=2048,U=8,V=32,D,H,N=[],S=[],I,ja,Q,ia,fa=0,na,$=new Sa,T={badspc:"invalid spc",badzip:"invalid zip",empty:"empty archive",unkty:"unknown file type",badurl:"invalid url",dlerr:"download error",
dlabt:"download aborted",nofile:"path not found in archive",io:"io error"};M=function(a,b,d){c();ca();var e=d?b:f;d&&(b=d.tracks[e]);var h=b.length;if(0>a)a+=h,0>a&&(a=0);else if(a>=h)if(d&&++e<d.tracks.length)a=0,b=d.tracks[e];else return G(),f;if(b!==g){var k,m;!d||d!==p?G():(k=g,m=q,A());j=b.url;i=b;s=d;r=e;B=0;F.postMessage({msg:"load",at:a,url:j,ofs:b._ofs});O(new J("loading",b,d,e,k,m))}else{var d=D,a=Math.floor(a*w),n;if(a<d){for(;S.length;)if(N.unshift(S.pop()),d-=Y,d<=a){D=d;na=1;t();return}n=
1}else if(a>d){for(;N.length;){if(d+Y>=a){D=d;na=1;t();return}S.push(N.shift());d+=Y}n=d+fa*Y<a}n&&(t(),qa(N),qa(S),fa=0,na=1,W.postMessage({msg:"seek",url:b.url,to:D=a}),l());da()}};Z=function(){var a=!!g&&!B;if(a){m();B=1;for(var b=(n.currentTime+H)*w;D>b;){var c=S.pop();if(!c)break;N.unshift(c);D-=c.byteLength>>>2}ia=0;O(new J("paused",g,p,q))}else j&&(a=B=!0);return a};da=function(){var a=!(!g||!B);a&&(0,k(),ca());return a};G=function(){var a=!!g;if(a){var b=g,c=p,d=q;A();g=p=q=E;O(new J("stopped",
b,c,d))}if(j||i)a=!0,j=i=s=r=E;a&&(B=0);return a};ea=function(){return g&&n?B||C?D/w:n.currentTime+H:-1};va=function(a,b){if(!a)throw new TypeError("url is not specified.");var a=X(location.href,a),d,e,g;b&&(d=b.autostart,e=b.userdata);(d=!!(d!==f?d:h.autostart))||oa("load");(g=e!==f)&&$.add(a,e);c();d&&(G(),i=s=r=E,j=a);F.postMessage({msg:"info",url:a,ap:d,u:g})};ma=function(a){u&&(u.gain.value=a)};xa(Ya);wa(!0);b=new ba(Ya);aa("init",0,b)}else ka?Ta(a):Ca(new ba(ra,"browser not supported"))})})})(this,
document);
