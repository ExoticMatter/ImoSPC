(function(q,S){function Ka(a){function b(){throw new TypeError("Illegal constructor");}a&&z(b,"prototype",a);return b}function La(){for(var a=-1,b=arguments.length;++a<b;){var c=arguments[a].prototype;z(c,"constructor",lb);z(arguments[a],"prototype",c)}}function oa(a){var b;b=h["on"+a];if(b!==$[a]&&k(b))b=1;else{b=A[a];var c=b.length,d=0;if(Array.isArray(b)&&c){for(var e=-1,f=b.length;++e<f;){var g=b[e];!k(g)&&(!w(g)||!k(g.handleEvent))&&d++}b=d<c}else b=void 0}if(!b)throw new TypeError(a+" event must be handled.");
}function Ma(a,b,c){a=A[a];if(Array.isArray(a))for(var d=-1,e=a.length;++d<e;){var f=a[d];k(f)?f.call(b,c):w(f)&&k(f.handleEvent)&&f.handleEvent(c)}}function aa(a,b,c){var d=h["on"+a],b=b||h;if(d!==$[a]&&k(d))try{d.call(b,c)}catch(e){}else Ma(a,b,c)}function Ba(a){aa("initerror",0,a)}function ha(a){aa("loaderror",0,a)}function O(a){aa("playstatechange",0,a)}function pa(a,b,c){a.prototype[b]||(a.prototype[b]=c)}function w(a){return a!==f&&a!==E}function k(a){return"function"===typeof a}function Ca(){}
function Na(a){if(!isNaN(a))return a;for(var a=String(a),b=0,c=-1,d=a.length;++c<d;)b=31*b+a.charCodeAt(c);return b}function qa(a){a.length=0}function x(a,b){return(a||"").localeCompare(b||"")}function Oa(a,b){return x(a.url,b.url)||x(a.title,b.title)}function Da(a,b){return x(a.title,b.title)||x(a.url,b.url)}function Ea(a,b){return x(a.osttitle,b.osttitle)||(a.ostdisc|0)-(b.ostdisc|0)||(a.osttracknum|0)-(b.osttracknum|0)||x(a.osttrackchar,b.osttrackchar)||Da(a,b)}function ba(a){var b="[ImoSPC v1.9.1, "+
("html5"===a?"HTML5]":"unitialized]");r(this,{runtime:a,major:1,minor:9,build:1,toString:function(){return b}})}function ca(a,b){r(this,{version:a||ra,error:b||sa})}function L(a,b,c,d,e,g,h){r(this,{url:a,userdata:b,track:c,playlist:g?E:d,corruptFiles:e,error:g,httpStatus:"download error"===g?h:f})}function J(a,b,c,d,e,f){r(this,{state:a,track:b,playlist:c,index:d,previousTrack:e,previousIndex:f})}function Pa(a){if(F!==f)a(F);else{var b=q.webkitURL||q.URL;if(!Qa||!ta||!ia||!mb||!q.Blob||!k(b.createObjectURL))H=
B(la?["flash"]:[]),a(F=!1);else try{var c=new Blob(['postMessage(self.FileReaderSync?"a":"")'],{type:"text/javascript"}),d=b.createObjectURL(c),e=new ta(d);e.onmessage=function(c){b.revokeObjectURL(d);e.terminate();H=c?["html5"]:[];la&&H.unshift("flash");B(H);a(F=!!c)}}catch(g){H=B(la?["flash"]:[]),a(F=!1)}}}function nb(a){for(var b="",a=a.split("%"),c=1,d=a.length;c<d;){var e=parseInt(a[c++],16);if(127<e){var f,g;if(192===(e&224))f=1,e&=31,g=128;else if(224===(e&240))f=2,e&=15,g=2048;else if(240===
(e&248))f=3,e&=7,g=65536;else{for(f=248===(e&252)?4:252===(e&254)?5:0;0<=--f;){var h=parseInt(a[c],16);if(128!==(h&192))break;c++}e=65533}for(;0<=--f;){h=parseInt(a[c],16);if(128!==(h&192)){e=65533;break}c++;e=e<<6|h&63}if(e<g||1114111<e||65534===e||65535===e)e=65533}65535<e?(e-=65536,b+=String.fromCharCode(55296+(e>>10),56320+(e&1023))):b+=String.fromCharCode(e)}return b}function Ra(){var a=[],b=[],c=[];this.remove=function(d){for(var e=Na(d),f=-1,g=a.length;++f<g;)if(a[f]===e&&b[f]===d)return d=
c[f],a.splice(f,1),b.splice(f,1),c.splice(f,1),d};this.add=function(f,e){a.push(Na(f));b.push(f);c.push(e)}}function P(a){var b=this;ob.forEach(function(c,f){z(b,c,a[f])});var c=a[0];if(c){var f,c=String(c),e=c.indexOf("#");0<=e?(f=c.substring(0,e),c=c.substring(e+1),c=String(c).replace(/((?:%[a-f\d]{2})+)/ig,nb),r(this,{archive:f,path:c}),f=c.substring(c.lastIndexOf("/")+1)):f=c.lastIndexOf("data:",0)?c.lastIndexOf("blob:",0)?c.substring(c.search(/[^\/\\]*$/)):"[blob]":"[data]";z(b,"filename",f)}z(b,
"length",+a[12]+ +a[13])}function T(a){if(!(a instanceof P))throw new TypeError("Track functions can only be called on Track objects.");}function K(a,b){return!a||!b?a===b:a.url===b.url}function Q(a){z(this,"tracks",B(a));r(this,{tracks:B(a),length:a.length})}function Fa(a){if(!Array.isArray(a))throw new TypeError("tracks is not an array.");if(!a.length)throw new TypeError("tracks is empty.");a.forEach(function(a){if(!(a instanceof P))throw new TypeError("tracks contains an invalid track.");});Q.call(this,
a.slice())}function m(a){if(!(a instanceof Q))throw new TypeError("Playlist functions can only be called on Playlist objects.");}function u(a){return(t||n)===a}function Sa(a){function b(){if(C=S.body||S.getElementsByTagName("body")[0])if(C.appendChild(l),y&&(l=q._ImoSwf),Ga(function(){if(d){clearTimeout(d);d=null;U=!1;ua=function(a,b){if(!a)throw new TypeError("url is not specified.");var a=V(location.href,a),e,d;b&&(e=b.autostart,d=b.userdata);(e=!!(e!==f?e:h.autostart))||oa("load");d!==f&&r.add(a,
d);e&&(G(),j=a,t=i=v=X=s=f);l._getinfo(a.replace(/[$&\\<>"'\r\n]/g,c))};M=function(a,b,e){da();X=!1;var d=e?b:f;e&&(b=e.tracks[d]);var h=b.length;if(0>a)a+=h,0>a&&(a=0);else if(a>=h)if(e&&++d<e.tracks.length)a=0,b=e.tracks[d];else return G(),f;if(b!==g){if(!e||e!==n)G();else{l._stop(!1);var k=g,m=p;g=p=f}j=V(location.href,b.url);i=b;t=e;s=d;v=a;O(new J("loading",i,t,s,k,m));l._load(j.replace(/[$&\\<>"'\r\n]/g,c),+b._fSt,+b._fLn)}else s=t=j=i=f,n=e,p=d,l._seek(a),l._resume()};Z=function(){return j?
X=!0:l._pause()};ea=function(){da();return j?(X=!1,!0):l._resume()};G=function(){return j?(j=i=t=s=v=f,!0):l._stop(!0)};fa=function(){return l._tell()||-1};ma=function(a){l._setVol(a)};var a={badspc:"invalid spc",badzip:"invalid zip",empty:"empty archive",unkty:"unknown file type",badurl:"invalid url",dlerr:"download error",http:"download error",security:"download error",dlabt:"download aborted",nofile:"path not found in archive",io:"io error"};Ha(function(a,b,c){a=e(a);if(b)for(var d=-1,g=b.length;++d<
g;){var h=b[d];Array.isArray(h)&&k(h)}k(c);d=r.remove(a);if(b.length){g=-1;for(h=b.length;++g<h;){var l=b[g]=new P(b[g]);d!==f&&z(l,"userdata",d)}g=new Q(b);d!==f&&z(g,"userdata",d);b=new L(a,d,1===b.length?b[0]:f,g,c||[],sa);aa("load",0,b);a===j&&!i&&(j=f,a=X,M(0,0,g),X=a)}else ha(new L(a,d,f,f,c,"empty archive"))},function(a){a=e(a);a===j&&(a=v,g=i,n=t,p=s,j=i=t=v=s=f,l._start(X),0<a&&l._seek(a),X&&O(new J("paused",g,n,p)))},function(b,c,d){b=e(b);"string"===typeof d&&(d=e(d));var c=a[c],g,h,l;
i?(g=i.userdata,s=t=j=i=f):(g=r.remove(b),b===j&&(s=t=j=i=f));switch(c){case "download error":h=+d||f;break;case "invalid spc":case "empty archive":case "path not found in archive":l=Array.isArray(d)?d:[]}ha(new L(b,g,i,t,l,c,h))},function(a){var b,c=g,d=n,e=p;switch(a){case "buffering":b="buffering";break;case "playing":b="playing";break;case "paused":b="paused";break;case "end":if(n&&h.autoplay&&++p<n.tracks.length){M(0,p,n);return}case "stopped":b="stopped",g=n=p=f}O(new J(b,c,d,e))});va(!0);wa(Ta);
var b=new ca(Ta);aa("init",0,b)}}),"none"===l.style.display||l.bgInactive)Ba(new ca(E,"swf blocked"));else var d=setTimeout(function(){U=!1;C.removeChild(l);d=l=null;Ba(new ca(E,"swf load timeout"))},a&&+a.timeout||5E3);else setTimeout(b,100)}function c(a){return w[a]||a}function d(a,b){return String.fromCharCode(parseInt(b,16))}function e(a){return a.replace(/\$([a-f0-9A-F]{2,2})/g,d)}function k(a){if(a)for(var b=-1,c=a.length;++b<c;){var d=a[b];"string"===typeof d&&(a[b]=e(d))}return a}var m=V(xa,
"imo-fl.swf"),l=S.createElement("div");l.innerHTML='<object id="_ImoSwf" type="application/x-shockwave-flash" data="'+m+'" style="width:1px;height:1px;position:absolute;top:0;'+(y?'left:-1px" classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000':"left:0;visibility:hidden")+'"><param name="movie" value="'+m+'"/><param name="allowScriptAccess" value="always"/></object>';l=l.firstChild;U=!0;var C,w={$:"$24","&":"$26","<":"$3C",">":"$3E","\\":"$5C",'"':"$22","'":"$27","\r":"$0D","\n":"$0A"},r=new Ra,X,
v;b()}var f,E=null,lb=Ka(),A={init:[],initerror:[],load:[],loaderror:[],playstatechange:[]},$={},pb=function(a){return function(b){Ma(a,this,b)}},ya;for(ya in A)A.hasOwnProperty(ya)&&($[ya]=pb(ya));var y;var Ia=window.navigator.userAgent,Ja=Ia.indexOf("MSIE ");y=0<Ja?parseInt(Ia.substring(Ja+5,Ia.indexOf(".",Ja)),10):void 0;if(!Array.isArray||y&&9>y)Array.isArray=function(a){return"[object Array]"===Object.prototype.toString.call(a)};var Qa=q.ArrayBuffer,ia=q.AudioContext||q.webkitAudioContext,ta=
q.Worker,mb=q.XMLHttpRequest,B=Object.freeze||function(a){return a};pa(Array,"forEach",function(a,b){b||(b=null);for(var c=this.length>>>0,d=-1;++d<c;)d in this&&a.call(b,this[d],d,this)});pa(Array,"indexOf",function(a,b){var c=this.length>>>0,b=b|0;0>b&&(b+=c,0>b&&(b=0));for(;b<c;b++)if(this[b]===a)return b;return-1});var z,r;Object.defineProperty&&(!y||8<y)?(z=function(a,b,c,d){Object.defineProperty(a,b,{configurable:!1,writable:!1,enumerable:!d&&"prototype"!==b,value:c})},r=function(a,b,c){for(var d in b)b[d]=
{configurable:!1,writable:!1,enumerable:!c,value:b[d]};Object.defineProperties(a,b)}):(z=function(a,b,c){a[b]=c},r=function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])});var V,Ua=function(a){return(a=String(a).replace(/^\s+|\s+$/g,"").match(/^([^:\/?#]+:)?(\/\/(?:[^:@]*(?::[^:@]*)?@)?(([^:\/?#]*)(?::(\d*))?))?([^?#]*)(\?[^#]*)?(#[\s\S]*)?/))?{href:a[0]||"",protocol:a[1]||"",authority:a[2]||"",host:a[3]||"",hostname:a[4]||"",port:a[5]||"",pathname:a[6]||"",search:a[7]||"",hash:a[8]||""}:null};
V=function(a,b){var b=Ua(b||""),a=Ua(a||""),c;if(!b||!a)c=null;else{c=(b.protocol||a.protocol)+(b.protocol||b.authority?b.authority:a.authority);var d;d=b.protocol||b.authority||"/"===b.pathname.charAt(0)?b.pathname:b.pathname?(a.authority&&!a.pathname?"/":"")+a.pathname.slice(0,a.pathname.lastIndexOf("/")+1)+b.pathname:a.pathname;var e=[];d.replace(/^(\.\.?(\/|$))+/,"").replace(/\/(\.(\/|$))+/g,"/").replace(/\/\.\.$/,"/../").replace(/\/?[^\/]*/g,function(a){"/.."===a?e.pop():e.push(a)});d=e.join("").replace(/^\//,
"/"===d.charAt(0)?"/":"");c=c+d+(b.protocol||b.authority||b.pathname?b.search:b.search||a.search)+b.hash}return c};var xa,Va=S.getElementsByTagName("script");xa=V(location.href,Va[Va.length-1].src);var sa=f,qb=B({SUCCESS:sa,UNKNOWN:"unknown error",INVALID_SPC:"invalid spc",INVALID_ZIP:"invalid zip",EMPTY_ARCHIVE:"empty archive",UNKNOWN_FILE_TYPE:"unknown file type",BAD_URL:"invalid url",DOWNLOAD_ERROR:"download error",DOWNLOAD_ABORTED:"download aborted",IO_ERROR:"io error",PATH_NOT_FOUND:"path not found in archive",
BROWSER_NOT_SUPPORTED:"browser not supported",TIMEOUT:"swf load timeout",FLASHBLOCK:"swf blocked"}),Wa=E,rb=B({NONE:Wa,HTML5:"html5",FLASH:"flash"}),sb=B({STOPPED:"stopped",PLAYING:"playing",PAUSED:"paused",BUFFERING:"buffering",LOADING:"loading"}),tb=B({Title:Da,Game:function(a,b){return x(a.game,b.game)||Da(a,b)},URL:Oa,Filename:function(a,b){return x(a.filename,b.filename)||Oa(a,b)},Chronological:Ea});La(ba);var ra=new ba(Wa),Xa=new ba("html5"),Ta=new ba("flash");La(ca,L,J);var F,H,la=function(){var a,
b,c=navigator.plugins,d=navigator.mimeTypes;if(!y&&c)if(c["Shockwave Flash"])if((a=c["Shockwave Flash"].description)&&(!d||!d["application/x-shockwave-flash"]||d["application/x-shockwave-flash"].enabledPlugin)){var e=a.match(/(\d+)/g);a=e[0];b=e[1]}else return;else return;else if("function"===typeof ActiveXObject)try{e=(new ActiveXObject("ShockwaveFlash.ShockwaveFlash")).GetVariable("$version"),e=e.split(" ")[1].split(","),a=e[0],b=e[1]}catch(f){return}else return;a=parseInt(a,10);b=parseInt(b,10);
return 11<a||11===a&&5<=b}(),da;if("undefined"!==q.Storage){da=function(){try{h.allowMultipleInstances||localStorage.setItem("_ImoCurrentInstanceController",localStorage.getItem("_ImoCurrentInstanceController")^1)}catch(a){}};var Ya=function(a){Z&&"_ImoCurrentInstanceController"===(a||q.event).key&&Z()};k(q.addEventListener)?q.addEventListener("storage",Ya,!1):k(q.attatchEvent)?q.attatchEvent("onstorage",Ya):da=Ca}else da=Ca;var za=1,ua,M,Z,ea,G,fa,ma,n,g,p,j,i,t,s,C,va,wa,Za,ob="url _ofs title game artist publisher copyright osttitle ostdisc osttrack osttracknum osttrackchar _fSt _fLn".split(" ");
r(P.prototype,{play:Za=function(a){T(this);M(+a||0,this)},pause:function(){T(this);return K(i||g,this)?Z():!1},unpause:function(){T(this);return K(i||g,this)?ea():!1},stop:function(){T(this);return K(i||g,this)?G():!1},time:function(){T(this);return K(g,this)?fa():-1},seek:function(a,b){T(this);if(isNaN(a))throw new TypeError("to must be a number.");if(K(g,this)&&(a||!b)){var c=fa();if(0<=c)return b&&(a+=c),M(a,n?p:g,n),!0}return!1},toString:function(a){a=this;return"[ImoSPC.Track, "+(a.title||a.filename||
a.url)+"]"}});var $a;r(Q.prototype,{constructor:Fa,play:$a=function(a,b){m(this);var c=this.tracks;if(w(a)&&isNaN(a))if(a instanceof P)a=c.indexOf(a);else throw new TypeError("track must be a Track object or the index of a track.");else a=+a;if(w(b)&&isNaN(b))throw new TypeError("startAt must be a number.");if(0>a||a>c.length||!(c[a>>>=0]instanceof P))throw new RangeError("track is not in the playlist.");M(+b||0,a,this)},pause:function(){m(this);return u(this)?Z():!1},unpause:function(){m(this);return u(this)?
ea():!1},stop:function(){m(this);return u(this)?G():!1},first:function(){m(this);return this.tracks[0]},previous:function(){m(this);return u(this)?this.tracks[(w(s)?s:p)-1]:f},current:function(){m(this);return u(this)?i||g:f},next:function(){m(this);return u(this)?this.tracks[(w(s)?s:p)+1]:f},last:function(){m(this);var a=this.tracks;return a[a.length-1]},indexOfFirst:function(){m(this);return 0},indexOfPrevious:function(){m(this);return u(this)?p-1:-1},indexOfCurrent:function(){m(this);return u(this)?
g:-1},indexOfNext:function(){m(this);var a=this.tracks.length,b=(w(s)?s:p)+1;return u(this)&&b<a?b:-1},indexOfLast:function(){m(this);return this.tracks.length-1},sort:function(a){m(this);if(w(a)){if(!k(a))throw new TypeError("compareFunction is not a function.");}else a=Ea;return new Q(this.tracks.slice().sort(a))},sortReverse:function(a){m(this);if(w(a)){if(!k(a))throw new TypeError("compareFunction is not a function.");}else a=Ea;return new Q(this.tracks.slice().sort(a).reverse())},toString:function(){return"[ImoSPC.Playlist, "+
this.length+" track(s)]"}});z(Fa,"prototype",Q.prototype);var U,h={};r(h,{Error:qb,Runtime:rb,PlaybackState:sb,TrackSort:tb,Playlist:Fa,Track:Ka(P.prototype),InitEvent:ca,LoadEvent:L,PlayStateEvent:J,currentTrack:function(){return i||g},currentPlaylist:function(){return t||n},querySupportedRuntimes:function(a){F!==f?a(H):Pa(function(){a(H)})},open:function(a,b){ua(a,b)},play:function(a,b,c){if(!arguments.length)throw new TypeError("ImoSPC.play() cannot be called without arguments.");if(a instanceof
Q)$a.call(a,b,c);else if(a instanceof P)Za.call(a,b);else throw new TypeError("The first argument of ImoSPC.play() must be a track or playlist.");},pause:function(){return Z()},unpause:function(){return ea()},stop:function(){return G()},time:function(){return fa?fa():-1},getVolume:function(){return za},setVolume:function(a){if(isNaN(a=+a))throw new TypeError("volume must be a number.");if(0>a||1<a)throw new RangeError("volume must be between 0 and 1.");za=a;ma&&ma(a);return za},canSeek:!0,canSetVolume:!0,
addEventListener:function(a,b){if(!k(b)&&(!w(b)||!k(b.handleEvent)))throw new TypeError("callback must be a function or event handler.");var c=A[a];Array.isArray(c)&&c.push(b)},removeEventListener:function(a,b){if(!k(b)&&(!w(b)||!k(b.handleEvent)))throw new TypeError("callback must be a function or event handler.");var c=A[a];if(Array.isArray(c)){var d=c.lastIndexOf(b);0<=d&&c.splice(d,1)}},toString:function(){return String(this.version)}});if(Object.defineProperties&&(!y||8<y)){var ab=ra,bb=!1,cb=
!0,db=!1;Object.defineProperties(h,{isFunctional:{enumerable:!0,configurable:!1,get:function(){return!(!ua||!M||!Z||!ea||!G||!fa||!ma)}},version:{enumerable:!0,configurable:!1,get:function(){return ab}},autostart:{enumerable:!0,configurable:!1,get:function(){return bb},set:function(a){bb=!!a}},autoplay:{enumerable:!0,configurable:!1,get:function(){return cb},set:function(a){cb=!!a}},allowMultipleInstances:{enumerable:!0,configurable:!1,get:function(){return db},set:function(a){db=!!a}}});va=function(){};
wa=function(a){ab=a}}else(va=function(a){h.isFunctional=!!a})(!1),(wa=function(a){h.version=a})(ra),h.autostart=!1,h.autoplay=!0,h.allowMultipleInstances=!1;for(var Aa in A)if(A.hasOwnProperty(Aa)){var eb="on"+Aa,fb=$[Aa];Object.defineProperty&&(!y||8<y)?function(a,b,c){Object.defineProperty(h,b,{enumerable:!0,configurable:!1,get:function(){return c},set:function(d){if(d)if(k(d))c=d;else throw new TypeError(b+" must be a function.");else c=$[a]}})}(Aa,eb,fb):h[eb]=fb}z(q,"ImoSPC",h);var Ga,Ha;if(Object.defineProperties&&
(!y||8<y)){var gb,hb,ib,jb,kb;Object.defineProperties(h,{_ready:{enumerable:!1,configurable:!1,get:function(){return gb}},_ongetinfo:{enumerable:!1,configurable:!1,get:function(){return hb}},_loaded:{enumerable:!1,configurable:!1,get:function(){return ib}},_onloaderror:{enumerable:!1,configurable:!1,get:function(){return jb}},_setstate:{enumerable:!1,configurable:!1,get:function(){return kb}}});Ga=function(a){gb=a};Ha=function(a,b,c,d){hb=a;ib=b;jb=c;kb=d}}else Ga=function(a){h._ready=a},Ha=function(a,
b,c,d){h._ongetinfo=a;h._loaded=b;h._onloaderror=c;h._setstate=d};z(h,"init",function(a){oa("init");oa("initerror");if(h.isFunctional||U)throw Error("ImoSPC is already initialized");a&&("autoplay"in a&&(h.autoplay=!!a.autoplay),"autostart"in a&&(h.autostart=!!a.autostart),"allowMultipleInstances"in a&&(h.allowMultipleInstances=!!a.allowMultipleInstances));la&&(!a||!("preferredRuntime"in a&&"html5"===a.preferredRuntime))?Sa(a):Pa(function(b){if(b){var c=function(){v=new ia;B=v.createGain();B.gain.value=
za;B.connect(v.destination);u=v.createGain();u.connect(B);H=new ta(V(xa,"imo-w-unzip.js"));W=new ta(V(xa,"imo-w-spc.js"));H.onmessage=d;W.onmessage=e;W.postMessage({msg:"setr",rate:x=v.sampleRate});var a=new Qa(1);W.postMessage({msg:"test",x:a},[a]);w=!a.length;c=Ca},d=function(a){var a=a.data,b="ok"===a.msg,c=a.url;switch(a.from){case "info":var d=a.bad||[],e=a.ls,g;a.u&&(g=ba.remove(c));if(b){e=a.ls;if(!e.length){ha(new L(c,g,f,f,d,"empty archive"));break}var h=[];e.forEach(function(a){a=new P(a);
g!==f&&z(a,"userdata",g);h.push(a)});b=new Q(h);g!==f&&z(b,"userdata",g);d=new L(c,g,1===b.length?h[0]:f,b,d,sa);aa("load",0,d);a.ap&&j===c&&(c=C,M(0,0,b),C=c)}else e=U[a.e]||"unknown error",a="download error"===e?a.code:f,ha(new L(c,g,f,f,d,e,a||f)),c===j&&(j=i=t=s=E);break;case "load":if(c!==j)break;b?(c=a.url,b=a.fi,a=a.at,W.postMessage({msg:"load",url:c,fi:b},w?[b]:f),a&&W.postMessage({msg:"seek",url:c,to:a*x})):(e=U[a.e]||"unknown error",a="download error"===e?a.code:f,d=i,b=t,j=i=t=s=E,ha(new L(c,
d.userdata,d,b,[],e,a)))}},e=function(a){var a=a.data,b="ok"===a.msg,c=a.url;switch(a.from){case "load":if(c!==j)break;b?(g=i,n=t,p=s,D=ja=F=0,K=+g._fSt,ka=+g.length,C?O(new J("paused",g,n,p)):k(),l()):"wrong url"!==a.e&&ha(new L(c,i.userdata,i,t,[],U[a.e]));j=i=t=s=E;break;case "samp":if(!g||c!==g.url)break;b&&(ga--,N.push(a.dat),l());break;case "seek":if(!g||c!==g.url)break;b&&(D=+a.at,0)}},k=function(){m();I=-1/0;C=0;u.gain.value=1;A=v.createScriptProcessor(Y,0,2);A.onaudioprocess=q;A.connect(u)},
m=function(){r();u.gain.value=0;A&&(A.disconnect(),A=A.onaudioprocess=E)},l=function(){if(g)for(var a=ka*x,b=D+(N.length+ga)*Y,c=T-(N.length+ga),d;0<c--&&b<a;)R.length>$?(d=R.shift(),w||(d=f)):d=f,W.postMessage({msg:"samp",url:g.url,rcl:d},d&&[d]),b+=Y,ga++},q=function(a){if(!g)throw Error("No track is loaded.");if(v.currentTime+I>=ka)return h.autoplay&&n&&++p<n.tracks.length?(m(),M(0,p,n)||(g=f)):G(),f;var b=a.playbackTime;isNaN(b)&&(b=v.currentTime+Y/x);var c=a.outputBuffer,a=c.getChannelData(0),
d=c.getChannelData(1),e=N.shift();if(e){R.push(e);var i=D/x;if(F||!ja)F=0,I=-1/0,ja=1,r(),O(new J("playing",g,n,p));if(b+I<i||na)if(na=0,I=i-b,!S&&isFinite(I)){var j=v.currentTime,i=j+I,b=ka-I;i<K?(i=1,j=K-I):i=-((i-K)/(ka-K))+1;var k=u.gain;k.value=i;k.setValueAtTime(i,j);k.linearRampToValueAtTime(0,b);S=1}b=new Int16Array(e);i=e=-1;for(c=c.length;++e<c;)a[e]=b[++i]/32768,d[e]=b[++i]/32768;D+=c}else{e=-1;for(c=c.length;++e<c;)a[e]=d[e]=0;if(b+I<ka&&(!F||!ja))ja=F=1,r(),O(new J("buffering",g,n,p))}l()},
r=function(){u.gain.cancelScheduledValues(S=0);u.gain.value=1},y=function(){m();qa(N);qa(R);C=ga=0;g=E};pa(ia,"createGain",ia.prototype.createGainNode);pa(ia,"createScriptProcessor",ia.prototype.createJavaScriptNode);var w,v,B,u,A,x,H,W,F,Y=2048,T=8,$=32,D,I,N=[],R=[],K,ka,S,ja,ga=0,na,ba=new Ra,U={badspc:"invalid spc",badzip:"invalid zip",empty:"empty archive",unkty:"unknown file type",badurl:"invalid url",dlerr:"download error",dlabt:"download aborted",nofile:"path not found in archive",io:"io error"};
M=function(a,b,d){c();da();var e=d?b:f;d&&(b=d.tracks[e]);var h=b.length;if(0>a)a+=h,0>a&&(a=0);else if(a>=h)if(d&&++e<d.tracks.length)a=0,b=d.tracks[e];else return G(),f;if(b!==g){var k,m;!d||d!==n?G():(k=g,m=p,y());j=b.url;i=b;t=d;s=e;C=0;H.postMessage({msg:"load",at:a,url:j,ofs:b._ofs});O(new J("loading",b,d,e,k,m))}else{var d=D,a=Math.floor(a*x),q;if(a<d){for(;R.length;)if(N.unshift(R.pop()),d-=Y,d<=a){D=d;na=1;r();return}q=1}else if(a>d){for(;N.length;){if(d+Y>=a){D=d;na=1;r();return}R.push(N.shift());
d+=Y}q=d+ga*Y<a}q&&(r(),qa(N),qa(R),ga=0,na=1,W.postMessage({msg:"seek",url:b.url,to:D=a}),l());ea()}};Z=function(){var a=!!g&&!C;if(a){m();C=1;for(var b=(v.currentTime+I)*x;D>b;){var c=R.pop();if(!c)break;N.unshift(c);D-=c.byteLength>>>2}ja=0;O(new J("paused",g,n,p))}else j&&(a=C=!0);return a};ea=function(){var a=!(!g||!C);a&&(0,k(),da());return a};G=function(){var a=!!g;if(a){var b=g,c=n,d=p;y();g=n=p=E;O(new J("stopped",b,c,d))}if(j||i)a=!0,j=i=t=s=E;a&&(C=0);return a};fa=function(){return g&&
v?C||F?D/x:v.currentTime+I:-1};ua=function(a,b){if(!a)throw new TypeError("url is not specified.");var a=V(location.href,a),d,e,g;b&&(d=b.autostart,e=b.userdata);(d=!!(d!==f?d:h.autostart))||oa("load");(g=e!==f)&&ba.add(a,e);c();d&&(G(),i=t=s=E,j=a);H.postMessage({msg:"info",url:a,ap:d,u:g})};ma=function(a){B&&(B.gain.value=a)};wa(Xa);va(!0);b=new ca(Xa);aa("init",0,b)}else la?Sa(a):Ba(new ca(ra,"browser not supported"))})})})(this,document);
